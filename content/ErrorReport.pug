| <?xml version="1.0"?>
| <?xml-stylesheet href="chrome://global/skin/" type="text/css"?>
| <?xml-stylesheet href="chrome://zotero-platform/content/zotero.css"?>
| <?xml-stylesheet href="chrome://global/skin/global.css"?>
| <?xml-stylesheet href="chrome://browser/skin/preferences/preferences.css"?>
| <?xml-stylesheet href="chrome://zotero/skin/preferences.css"?>
| <?xml-stylesheet href="chrome://zotero/skin/zotero.css"?>
| <?xml-stylesheet href="chrome://zotero-platform/content/overlay.css"?>
| <?xml-stylesheet href="chrome://zotero-better-bibtex/content/skin/preferences.css"?>
| <?xml-stylesheet href="chrome://zotero-better-bibtex/content/skin/error-report.css" type="text/css"?>
| <!DOCTYPE window [
|   <!ENTITY % ZoteroDTD SYSTEM "chrome://zotero/locale/zotero.dtd"> %ZoteroDTD;
|   <!ENTITY % BBTDTD SYSTEM "chrome://zotero-better-bibtex/locale/zotero-better-bibtex.dtd"> %BBTDTD;
|   <!ENTITY % standaloneDTD SYSTEM "chrome://zotero/locale/standalone.dtd"> %standaloneDTD;
| ]>
window(xmlns='http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul' xmlns:html='http://www.w3.org/1999/xhtml')
  linkset
    html:link(rel='localization' href='better-bibtex.ftl')
    html:link(rel='localization' href='toolkit/global/wizard.ftl')
  script(src='chrome://global/content/customElements.js')
  wizard(id='better-bibtex-error-report' title='&better-bibtex_error-report.title;' _width='700' _height='700')
    wizardpage(hidden pageid='page-enable-debug' label=' ')
      description(class='header' style='white-space: pre-wrap;') &better-bibtex_error-report_enable-debug;
      vbox
        button(label='&better-bibtex_error-report_restart-with-logging-enabled.label;' oncommand='window.ErrorReport.restartWithDebugEnabled()')
    wizardpage(hidden pageid='page-upgrade' label=' ')
      html:div
        html:p(id='better-bibtex-report-upgrade-bbt' data-l10n-id='better-bibtex_error-report_upgrade')
        html:p(id='better-bibtex-report-upgrade-zotero' data-l10n-id='better-bibtex_error-report_upgrade')
        html:p(id='better-bibtex-report-upgrade-zotero_auto' hidden data-l10n-id='better-bibtex_error-report_upgrade_auto')
        html:p(id='better-bibtex-report-upgrade-zotero_manual' hidden data-l10n-id='better-bibtex_error-report_upgrade_manual')
    wizardpage(hidden pageid='page-items' label=' ')
      html:div
        html:p(id='better-bibtex-report-no-items' data-l10n-id='better-bibtex_error-report_no_items')
        html:ul
          html:li(data-l10n-id='better-bibtex_error-report_no_items_cancel')
          html:li(data-l10n-id='better-bibtex_error-report_no_items_reproduce')
          html:li(data-l10n-id='better-bibtex_error-report_no_items_select')
          html:li(data-l10n-id='better-bibtex_error-report_no_items_popup')
          html:li(data-l10n-id='better-bibtex_error-report_no_items_report')
    wizardpage(pageid='page-review' label=' ')
      tooltip(id='better-bibtex-error-report-info') &better-bibtex_error-report_review;
      label(id='better-bibtex-report-cache' data-l10n-id='better-bibtex_error-report_better-bibtex_cache' flex='1' readonly='true')
      checkbox(class='better-bibtex-error-report-facet' id='better-bibtex-error-report-include-errors' checked label='&better-bibtex_error-report_include-errors.label;')
      checkbox(class='better-bibtex-error-report-facet' id='better-bibtex-error-report-include-log' checked label='&better-bibtex_error-report_include-log.label;')
      html:fieldset
        html:legend &better-bibtex_error-report_include-items.label;
        checkbox(class='better-bibtex-error-report-facet' id='better-bibtex-error-report-include-notes' checked label='&better-bibtex_error-report_include-notes.label;')
        checkbox(class='better-bibtex-error-report-facet' id='better-bibtex-error-report-include-attachments' checked label='&better-bibtex_error-report_include-attachments.label;')
        checkbox(class='better-bibtex-error-report-facet' id='better-bibtex-error-report-include-cache' checked label='&better-bibtex_error-report_include-cache.label;')
      tabbox(class='debug-on' flex='10')
        tabs
          tab(id='better-bibtex-error-context-tab' label='&better-bibtex_error-report_context.label;')
          tab(id='better-bibtex-error-errors-tab' label='&better-bibtex_error-report_errors.label;')
          tab(id='better-bibtex-error-log-tab' label='&better-bibtex_error-report_debug.label;')
          tab(id='better-bibtex-error-items-tab' label='&better-bibtex_error-report_items.label;')
        tabpanels(flex='1')
          tabpanel(flex='1' orient='vertical')
            html:textarea(id='better-bibtex-error-context' class='plain' readonly='true' multiline='true' flex='10' style='min-height: 8em;' tooltip='better-bibtex-error-report-info' cols='40' rows='5')
          tabpanel(flex='1' orient='vertical')
            html:textarea(id='better-bibtex-error-errors' class='plain' readonly='true' multiline='true' flex='10' style='min-height: 8em;' tooltip='better-bibtex-error-report-info' cols='40' rows='5')
          tabpanel(flex='1' orient='vertical')
            html:textarea(id='better-bibtex-error-log' class='plain' readonly='true' multiline='true' flex='10' style='min-height: 8em;' tooltip='better-bibtex-error-report-info' cols='40' rows='5')
          tabpanel(flex='1' orient='vertical')
            html:textarea(id='better-bibtex-error-items' class='plain' readonly='true' multiline='true' flex='10' style='min-height: 8em;' tooltip='better-bibtex-error-report-info' cols='40' rows='5')
      hbox
        button(label='&better-bibtex_error-report_save.label;' oncommand='window.ErrorReport.save()')
        hbox(flex='1')
      html:div(id='better-bibtex-error-send-reminder' data-l10n-id='better-bibtex-error-send-reminder')
    wizardpage(pageid='page-send' label=' ')
      description &better-bibtex_error-report_submission-in-progress;
    wizardpage(pageid='page-done' label=' ')
      description &better-bibtex_error-report_submitted;
      description(id='better-bibtex-report-result')
        description
          | &better-bibtex_error-report_report-id; 
          html:input(id='better-bibtex-report-id' class='plain' class='textbox-emph' flex='1' size=40 readonly='true' type='text')
      html:div(data-l10n-id='better-bibtex_error-report_post-to-github')
      html:a(href='https://github.com/retorquere/zotero-better-bibtex/issues' onclick='Zotero.launchURL("https://github.com/retorquere/zotero-better-bibtex/issues/new/choose")') https://github.com/retorquere/zotero-better-bibtex/issues
    script(src='chrome://zotero/content/include.js')
    script.
      window.addEventListener('load', function() {
        Zotero.BetterBibTeX.ErrorReport.load(window).catch(err => Zotero.debug(`BBT.ErrorReport: error: ${err}\n${err.stack}`))
      })
